<!DOCTYPE html><html lang="zh-CN"><head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>MySQL与Doris大数据量Excel导出技术方案</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&amp;family=Inter:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'serif': ['Playfair Display', 'serif'],
                        'sans': ['Inter', 'sans-serif']
                    },
                    colors: {
                        'primary': '#1e40af',
                        'secondary': '#64748b',
                        'accent': '#0ea5e9'
                    }
                }
            }
        }
    </script>
    <style>
        html { scroll-behavior: smooth; }
        body { overflow-x: hidden; }
        .gradient-overlay {
            background: linear-gradient(135deg, rgba(30, 64, 175, 0.15) 0%, rgba(14, 165, 233, 0.1) 100%);
        }
        .text-shadow {
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .backdrop-blur-sm { backdrop-filter: blur(4px); }
        .toc-fixed {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 280px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(12px);
            border-right: 1px solid #e2e8f0;
            z-index: 40;
            overflow-y: auto;
            padding: 2rem 1.5rem;
        }
        .main-content {
            margin-left: 280px;
            min-height: 100vh;
        }
        .toc-link {
            transition: all 0.2s ease;
        }
        .toc-link:hover {
            background-color: #f1f5f9;
            border-left: 3px solid #1e40af;
        }
        .section-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        .section-card:hover {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        .citation-link {
            color: #1e40af;
            text-decoration: none;
            font-weight: 500;
            border-bottom: 1px dotted #1e40af;
        }
        .citation-link:hover {
            background-color: #eff6ff;
            border-bottom: 1px solid #1e40af;
        }
        .hero-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: auto auto;
            gap: 1.5rem;
            align-items: center;
        }
        @media (max-width: 768px) {
            .hero-grid {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto;
            }
        }
        .hero-title {
            grid-column: 1 / -1;
            grid-row: 1;
        }
        .hero-content {
            grid-column: 1;
            grid-row: 2;
        }
        .hero-visual {
            grid-column: 2;
            grid-row: 2;
        }
        @media (max-width: 768px) {
            .hero-visual {
                grid-column: 1;
                grid-row: 3;
            }
        }
    </style>
  <base target="_blank">
</head>

  <body class="bg-gray-50 font-sans">
    <!-- 固定目录 -->
    <nav class="toc-fixed">
      <div class="mb-8">
        <h3 class="font-serif text-lg font-bold text-gray-900 mb-4">目录导航</h3>
      </div>
      <ul class="space-y-2 text-sm">
        <li>
          <a href="#overview" class="toc-link block px-3 py-2 text-gray-700 rounded-md">总体架构设计</a>
        </li>
        <li>
          <a href="#consistency" class="toc-link block px-3 py-2 text-gray-700 rounded-md">数据一致性方案</a>
        </li>
        <li>
          <a href="#mysql-solution" class="toc-link block px-3 py-2 text-gray-700 rounded-md">MySQL导出方案</a>
        </li>
        <li>
          <a href="#doris-solution" class="toc-link block px-3 py-2 text-gray-700 rounded-md">Doris导出方案</a>
        </li>
        <li>
          <a href="#merge-compress" class="toc-link block px-3 py-2 text-gray-700 rounded-md">文件合并与压缩</a>
        </li>
        <li>
          <a href="#industry-practices" class="toc-link block px-3 py-2 text-gray-700 rounded-md">业界实践案例</a>
        </li>
        <li>
          <a href="#performance" class="toc-link block px-3 py-2 text-gray-700 rounded-md">性能优化策略</a>
        </li>
      </ul>
    </nav>

    <!-- 主内容区 -->
    <main class="main-content">
      <!-- 顶部英雄区域 -->
      <section class="relative bg-white border-b border-gray-200">
        <div class="gradient-overlay absolute inset-0"></div>
        <div class="relative z-10 max-w-7xl mx-auto px-8 py-16">
          <div class="hero-grid">
            <div class="hero-title">
              <h1 class="font-serif text-4xl md:text-5xl font-bold text-gray-900 mb-6 leading-tight">
                <em class="text-primary">MySQL与Doris</em>
                <br/>
                大数据量Excel导出方案
              </h1>
              <p class="text-xl text-secondary font-medium mb-8">
                兼顾数据一致性、导出速度与内存使用的技术架构设计
              </p>
            </div>

            <div class="hero-content">
              <div class="bg-white/80 backdrop-blur-sm rounded-xl p-6 border border-gray-200">
                <h3 class="font-serif text-lg font-semibold text-gray-900 mb-4">核心架构原则</h3>
                <ul class="space-y-3 text-sm text-gray-700">
                  <li class="flex items-start">
                    <i class="fas fa-check-circle text-accent mt-1 mr-3"></i>
                    <span><strong>异步化处理：</strong>通过任务队列解耦请求与处理，避免超时问题</span>
                  </li>
                  <li class="flex items-start">
                    <i class="fas fa-check-circle text-accent mt-1 mr-3"></i>
                    <span><strong>流式处理：</strong>边读边写，控制内存使用，支持上亿行数据导出</span>
                  </li>
                  <li class="flex items-start">
                    <i class="fas fa-check-circle text-accent mt-1 mr-3"></i>
                    <span><strong>文件分片：</strong>自动切分大文件，压缩打包，提升传输效率</span>
                  </li>
                </ul>
              </div>
            </div>

            <div class="hero-visual">
              <div class="relative">
                <div class="absolute inset-0 bg-gradient-to-br from-primary/20 to-accent/20 rounded-2xl transform rotate-3"></div>
                <div class="relative bg-white rounded-2xl p-6 shadow-xl border border-gray-200">
                  <img src="https://kimi-web-img.moonshot.cn/img/pocdn.processon.com/4610bdb915d4b969eab4aac6d9ecb055f87f675b.png" alt="数据流架构抽象背景图" class="w-full h-48 object-cover rounded-lg mb-4" size="medium" aspect="wide" query="数据流架构抽象背景" referrerpolicy="no-referrer" data-modified="1" data-score="0.00"/>
                  <div class="text-center">
                    <div class="text-2xl font-bold text-primary">1,000万+</div>
                    <div class="text-sm text-secondary">支持数据行数</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- 内容区域 -->
      <div class="max-w-5xl mx-auto px-8 py-12 space-y-16">

        <!-- 总体架构设计 -->
        <section id="overview" class="section-card rounded-2xl p-8 shadow-lg">
          <div class="flex items-center mb-8">
            <div class="w-12 h-12 bg-primary rounded-xl flex items-center justify-center mr-4">
              <i class="fas fa-sitemap text-white text-xl"></i>
            </div>
            <h2 class="font-serif text-3xl font-bold text-gray-900">总体架构设计</h2>
          </div>

          <div class="grid md:grid-cols-3 gap-8 mb-12">
            <div class="bg-blue-50 rounded-xl p-6 border border-blue-200">
              <h3 class="font-serif text-xl font-semibold text-primary mb-4">异步化处理</h3>
              <p class="text-gray-700 text-sm leading-relaxed">
                将导出请求与文件生成过程解耦，通过任务队列实现后台处理，避免Web请求超时，提升系统稳定性。
                <a href="https://blog.csdn.net/huyuchengus/article/details/114240138" class="citation-link">[117]</a>
              </p>
            </div>
            <div class="bg-green-50 rounded-xl p-6 border border-green-200">
              <h3 class="font-serif text-xl font-semibold text-primary mb-4">流式处理</h3>
              <p class="text-gray-700 text-sm leading-relaxed">
                采用&#34;边读边写&#34;模式，通过数据库游标和流式文件写入库，将内存占用控制在合理范围。
                <a href="https://patents.google.com/patent/CN109299157B/zh" class="citation-link">[119]</a>
              </p>
            </div>
            <div class="bg-purple-50 rounded-xl p-6 border border-purple-200">
              <h3 class="font-serif text-xl font-semibold text-primary mb-4">文件分片</h3>
              <p class="text-gray-700 text-sm leading-relaxed">
                按行数或大小自动切分大文件，压缩打包后提供下载，解决单个文件过大问题。
                <a href="https://blog.csdn.net/2301_78947898/article/details/147897818" class="citation-link">[124]</a>
              </p>
            </div>
          </div>

          <div class="bg-gray-50 rounded-xl p-6 border-l-4 border-primary">
            <h4 class="font-semibold text-gray-900 mb-3">导出流程概览</h4>
            <div class="grid md:grid-cols-5 gap-4 text-sm">
              <div class="text-center">
                <div class="w-10 h-10 bg-primary text-white rounded-full flex items-center justify-center mx-auto mb-2">1</div>
                <div>用户发起请求</div>
              </div>
              <div class="text-center">
                <div class="w-10 h-10 bg-primary text-white rounded-full flex items-center justify-center mx-auto mb-2">2</div>
                <div>任务队列处理</div>
              </div>
              <div class="text-center">
                <div class="w-10 h-10 bg-primary text-white rounded-full flex items-center justify-center mx-auto mb-2">3</div>
                <div>数据查询与文件生成</div>
              </div>
              <div class="text-center">
                <div class="w-10 h-10 bg-primary text-white rounded-full flex items-center justify-center mx-auto mb-2">4</div>
                <div>文件压缩与存储</div>
              </div>
              <div class="text-center">
                <div class="w-10 h-10 bg-primary text-white rounded-full flex items-center justify-center mx-auto mb-2">5</div>
                <div>结果通知与下载</div>
              </div>
            </div>
          </div>
        </section>

        <!-- 数据一致性方案 -->
        <section id="consistency" class="section-card rounded-2xl p-8 shadow-lg">
          <div class="flex items-center mb-8">
            <div class="w-12 h-12 bg-primary rounded-xl flex items-center justify-center mr-4">
              <i class="fas fa-shield-alt text-white text-xl"></i>
            </div>
            <h2 class="font-serif text-3xl font-bold text-gray-900">数据一致性方案</h2>
          </div>

          <div class="mb-8">
            <div class="bg-blue-50 border-l-4 border-blue-400 p-6 mb-8">
              <div class="flex items-start">
                <i class="fas fa-info-circle text-blue-400 mt-1 mr-3"></i>
                <div>
                  <h4 class="font-semibold text-blue-900 mb-2">一致性级别选择原则</h4>
                  <p class="text-blue-800 text-sm">
                    在绝大多数场景下，系统稳定性优先于数据一致性。但对于财务、审计等核心合规场景，则必须不惜代价保证数据的一致性。
                    <a href="https://blog.csdn.net/qq719779232/article/details/156294111" class="citation-link">[120]</a>
                  </p>
                </div>
              </div>
            </div>
          </div>

          <div class="grid md:grid-cols-2 gap-8">
            <div class="bg-gradient-to-br from-yellow-50 to-orange-50 rounded-xl p-6 border border-orange-200">
              <h3 class="font-serif text-xl font-semibold text-orange-900 mb-4 flex items-center">
                <i class="fas fa-file-alt mr-3"></i>&#34;普通报表&#34;级别
              </h3>
              <div class="space-y-4">
                <div>
                  <h4 class="font-medium text-gray-900 mb-2">MySQL实现</h4>
                  <p class="text-sm text-gray-700">基于主键或唯一索引的分页查询，避免使用OFFSET，性能稳定但不保证一致性。</p>
                </div>
                <div>
                  <h4 class="font-medium text-gray-900 mb-2">Doris实现</h4>
                  <p class="text-sm text-gray-700">直接使用SELECT INTO OUTFILE命令，支持并行导出和自动分片，性能优异。</p>
                </div>
              </div>
            </div>

            <div class="bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200">
              <h3 class="font-serif text-xl font-semibold text-green-900 mb-4 flex items-center">
                <i class="fas fa-certificate mr-3"></i>&#34;一致性报表&#34;级别
              </h3>
              <div class="space-y-4">
                <div>
                  <h4 class="font-medium text-gray-900 mb-2">MySQL实现</h4>
                  <p class="text-sm text-gray-700">基于REPEATABLE READ事务隔离级别的MVCC机制，通过长事务保证快照一致性。</p>
                </div>
                <div>
                  <h4 class="font-medium text-gray-900 mb-2">Doris实现</h4>
                  <p class="text-sm text-gray-700">基于内置快照机制，自动创建一致性视图，保证导出数据的时点一致性。</p>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- MySQL导出方案 -->
        <section id="mysql-solution" class="section-card rounded-2xl p-8 shadow-lg">
          <div class="flex items-center mb-8">
            <div class="w-12 h-12 bg-primary rounded-xl flex items-center justify-center mr-4">
              <i class="fas fa-database text-white text-xl"></i>
            </div>
            <h2 class="font-serif text-3xl font-bold text-gray-900">MySQL大数据量导出方案</h2>
          </div>

          <div class="space-y-8">
            <div class="bg-gray-50 rounded-xl p-6">
              <h3 class="font-serif text-xl font-semibold text-gray-900 mb-4">分页查询策略</h3>
              <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-white rounded-lg p-4 border border-gray-200">
                  <h4 class="font-medium text-green-700 mb-2 flex items-center">
                    <i class="fas fa-check-circle mr-2"></i>推荐方案
                  </h4>
                  <p class="text-sm text-gray-700 mb-2">基于主键范围查询</p>
                  <code class="text-xs bg-gray-100 p-2 rounded block">SELECT * FROM table WHERE id &gt; {last_max_id} ORDER BY id ASC LIMIT 10000</code>
                </div>
                <div class="bg-white rounded-lg p-4 border border-gray-200">
                  <h4 class="font-medium text-red-700 mb-2 flex items-center">
                    <i class="fas fa-times-circle mr-2"></i>避免使用
                  </h4>
                  <p class="text-sm text-gray-700 mb-2">OFFSET深度分页</p>
                  <code class="text-xs bg-gray-100 p-2 rounded block">SELECT * FROM table LIMIT 10000000, 10000</code>
                </div>
              </div>
            </div>

            <div class="bg-blue-50 rounded-xl p-6">
              <h3 class="font-serif text-xl font-semibold text-gray-900 mb-4">流式写入实现</h3>
              <div class="space-y-4">
                <div class="flex items-start">
                  <i class="fas fa-arrow-right text-accent mt-1 mr-3"></i>
                  <div>
                    <h4 class="font-medium text-gray-900">pandas分块读取</h4>
                    <p class="text-sm text-gray-700">使用chunksize参数实现分块读取，避免内存溢出。
                      <a href="https://cloud.tencent.com/developer/article/2492211" class="citation-link">[188]</a>
                    </p>
                  </div>
                </div>
                <div class="flex items-start">
                  <i class="fas fa-arrow-right text-accent mt-1 mr-3"></i>
                  <div>
                    <h4 class="font-medium text-gray-900">openpyxl流式写入</h4>
                    <p class="text-sm text-gray-700">使用write_only模式，支持大文件写入而不占用过多内存。
                      <a href="https://zhuanlan.zhihu.com/p/1949062903450797622" class="citation-link">[184]</a>
                    </p>
                  </div>
                </div>
                <div class="flex items-start">
                  <i class="fas fa-arrow-right text-accent mt-1 mr-3"></i>
                  <div>
                    <h4 class="font-medium text-gray-900">直接写入CSV</h4>
                    <p class="text-sm text-gray-700">追求极致性能时，直接写入CSV格式，速度最快，资源消耗最低。
                      <a href="https://blog.csdn.net/weixin_61226361/article/details/147982956" class="citation-link">[141]</a>
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Doris导出方案 -->
        <section id="doris-solution" class="section-card rounded-2xl p-8 shadow-lg">
          <div class="flex items-center mb-8">
            <div class="w-12 h-12 bg-primary rounded-xl flex items-center justify-center mr-4">
              <i class="fas fa-cloud text-white text-xl"></i>
            </div>
            <h2 class="font-serif text-3xl font-bold text-gray-900">Doris大数据量导出方案</h2>
          </div>

          <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 mb-8 border border-blue-200">
            <h3 class="font-serif text-xl font-semibold text-blue-900 mb-4">SELECT INTO OUTFILE命令</h3>
            <p class="text-blue-800 text-sm mb-4">
              Doris的核心导出命令，支持直接将查询结果导出到分布式存储系统，内置并行处理机制。
              <a href="https://doris.apache.org/zh-CN/docs/3.x/data-operate/export/export-overview/" class="citation-link">[108]</a>
            </p>

            <div class="bg-white rounded-lg p-4 border border-blue-200">
              <div class="text-xs text-gray-600 mb-2">基本语法</div>
              <code class="text-sm text-gray-800 block">
                            SELECT select_statement<br/>
                            INTO OUTFILE &#34;file_path&#34;<br/>
                            [FORMAT AS file_format]<br/>
                            [PROPERTIES (key1=value1, ...)];
                        </code>
            </div>
          </div>

          <div class="grid md:grid-cols-2 gap-8">
            <div class="bg-green-50 rounded-xl p-6 border border-green-200">
              <h4 class="font-semibold text-green-900 mb-4">导出格式支持</h4>
              <ul class="space-y-2 text-sm text-green-800">
                <li class="flex items-center"><i class="fas fa-file-csv mr-2"></i>CSV格式（默认）</li>
                <li class="flex items-center"><i class="fas fa-file-archive mr-2"></i>Parquet列式存储</li>
                <li class="flex items-center"><i class="fas fa-file-code mr-2"></i>ORC格式</li>
              </ul>
            </div>

            <div class="bg-purple-50 rounded-xl p-6 border border-purple-200">
              <h4 class="font-semibold text-purple-900 mb-4">存储目标</h4>
              <ul class="space-y-2 text-sm text-purple-800">
                <li class="flex items-center"><i class="fas fa-server mr-2"></i>HDFS分布式文件系统</li>
                <li class="flex items-center"><i class="fas fa-cloud mr-2"></i>S3对象存储</li>
                <li class="flex items-center"><i class="fas fa-database mr-2"></i>本地文件系统</li>
              </ul>
            </div>
          </div>

          <div class="mt-8 bg-yellow-50 rounded-xl p-6 border border-yellow-200">
            <h4 class="font-semibold text-yellow-900 mb-3">自动分片与并行导出</h4>
            <p class="text-yellow-800 text-sm">
              Doris会自动将大型查询结果分割成多个文件，并行写入，充分利用MPP架构优势。
              通过SHOW EXPORT命令可监控导出任务的详细信息，包括并发线程数、文件大小等。
              <a href="https://doris.apache.org/zh-CN/docs/3.x/data-operate/export/export-best-practice/" class="citation-link">[131]</a>
            </p>
          </div>
        </section>

        <!-- 文件合并与压缩 -->
        <section id="merge-compress" class="section-card rounded-2xl p-8 shadow-lg">
          <div class="flex items-center mb-8">
            <div class="w-12 h-12 bg-primary rounded-xl flex items-center justify-center mr-4">
              <i class="fas fa-compress-alt text-white text-xl"></i>
            </div>
            <h2 class="font-serif text-3xl font-bold text-gray-900">文件合并与压缩方案</h2>
          </div>

          <div class="grid md:grid-cols-2 gap-8 mb-8">
            <div class="bg-blue-50 rounded-xl p-6 border border-blue-200">
              <h3 class="font-serif text-xl font-semibold text-blue-900 mb-4">多源数据合并</h3>
              <div class="space-y-4">
                <div class="bg-white rounded-lg p-4 border border-gray-200">
                  <h4 class="font-medium text-gray-900 mb-2">MySQL与Doris合并</h4>
                  <p class="text-sm text-gray-700">分别导出后统一格式，基于关键字段进行数据关联合并</p>
                </div>
                <div class="bg-white rounded-lg p-4 border border-gray-200">
                  <h4 class="font-medium text-gray-900 mb-2">业务规则关联</h4>
                  <p class="text-sm text-gray-700">按用户ID、订单号等业务主键进行数据关联和整合</p>
                </div>
              </div>
            </div>

            <div class="bg-green-50 rounded-xl p-6 border border-green-200">
              <h3 class="font-serif text-xl font-semibold text-green-900 mb-4">压缩策略</h3>
              <div class="space-y-4">
                <div class="bg-white rounded-lg p-4 border border-gray-200">
                  <h4 class="font-medium text-gray-900 mb-2">zipfile压缩</h4>
                  <p class="text-sm text-gray-700">使用Python标准库将多个分片文件压缩为单个zip包
                    <a href="https://blog.csdn.net/2301_78947898/article/details/147897818" class="citation-link">[124]</a>
                  </p>
                </div>
                <div class="bg-white rounded-lg p-4 border border-gray-200">
                  <h4 class="font-medium text-gray-900 mb-2">算法选择</h4>
                  <p class="text-sm text-gray-700">默认DEFLATE算法，中等压缩级别，平衡压缩率和速度</p>
                </div>
              </div>
            </div>
          </div>

          <div class="bg-gradient-to-r from-gray-50 to-gray-100 rounded-xl p-6">
            <h3 class="font-serif text-xl font-semibold text-gray-900 mb-4">压缩实现示例</h3>
            <div class="bg-white rounded-lg p-4 border border-gray-200">
              <div class="text-xs text-gray-600 mb-2">Python实现代码</div>
              <pre class="text-xs text-gray-800 overflow-x-auto"><code>import zipfile
import os

def compress_files(file_list, output_zip):
    with zipfile.ZipFile(output_zip, &#39;w&#39;, zipfile.ZIP_DEFLATED) as zf:
        for file in file_list:
            zf.write(file, os.path.basename(file))
            # 可选：压缩后删除原文件
            os.remove(file)
return output_zip</code></pre>
            </div>
          </div>
        </section>

        <!-- 业界实践案例 -->
        <section id="industry-practices" class="section-card rounded-2xl p-8 shadow-lg">
          <div class="flex items-center mb-8">
            <div class="w-12 h-12 bg-primary rounded-xl flex items-center justify-center mr-4">
              <i class="fas fa-industry text-white text-xl"></i>
            </div>
            <h2 class="font-serif text-3xl font-bold text-gray-900">业界实践与案例分析</h2>
          </div>

          <div class="space-y-8">
            <div class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200">
              <h3 class="font-serif text-xl font-semibold text-blue-900 mb-4 flex items-center">
                <i class="fas fa-university mr-3"></i>金融行业实践
              </h3>
              <div class="grid md:grid-cols-2 gap-6">
                <div>
                  <h4 class="font-medium text-gray-900 mb-2">异步导出架构</h4>
                  <p class="text-sm text-gray-700 mb-3">
                    采用Celery任务队列，支持任务持久化、重试和状态监控，确保高可靠性。
                    <a href="https://blog.csdn.net/qq_52066082/article/details/141304476" class="citation-link">[232]</a>
                  </p>
                </div>
                <div>
                  <h4 class="font-medium text-gray-900 mb-2">安全存储策略</h4>
                  <p class="text-sm text-gray-700 mb-3">
                    文件上传至S3私有Bucket，生成带有效期的签名URL，确保数据安全。
                    <a href="https://www.ibm.com/docs/zh/engineering-lifecycle-management-suite/lifecycle-management/7.1.0?topic=builder-exporting-reports-compressed-files" class="citation-link">[125]</a>
                  </p>
                </div>
              </div>
            </div>

            <div class="bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-6 border border-green-200">
              <h3 class="font-serif text-xl font-semibold text-green-900 mb-4 flex items-center">
                <i class="fas fa-rocket mr-3"></i>互联网企业实践
              </h3>
              <div class="space-y-4">
                <div class="bg-white rounded-lg p-4 border border-gray-200">
                  <h4 class="font-medium text-gray-900 mb-2">分布式并行导出</h4>
                  <p class="text-sm text-gray-700">
                    菜鸟网络利用Doris处理数百亿行数据的多表关联查询，通过调整parallelism参数控制并发度。
                    <a href="https://www.velodb.io/blog/apache-doris-empowers-realtime-lakehouse-cainiao" class="citation-link">[223]</a>
                  </p>
                </div>
                <div class="bg-white rounded-lg p-4 border border-gray-200">
                  <h4 class="font-medium text-gray-900 mb-2">导出API设计</h4>
                  <p class="text-sm text-gray-700">
                    设计RESTful API，支持参数校验、权限控制、任务状态查询和结果通知。
                    <a href="https://www.cnblogs.com/Mr-Sponge/p/18210983" class="citation-link">[207]</a>
                  </p>
                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- 性能优化策略 -->
        <section id="performance" class="section-card rounded-2xl p-8 shadow-lg">
          <div class="flex items-center mb-8">
            <div class="w-12 h-12 bg-primary rounded-xl flex items-center justify-center mr-4">
              <i class="fas fa-tachometer-alt text-white text-xl"></i>
            </div>
            <h2 class="font-serif text-3xl font-bold text-gray-900">性能优化与最佳实践</h2>
          </div>

          <div class="grid md:grid-cols-3 gap-6 mb-8">
            <div class="bg-blue-50 rounded-xl p-6 border border-blue-200 text-center">
              <i class="fas fa-link text-3xl text-blue-600 mb-4"></i>
              <h3 class="font-serif text-lg font-semibold text-blue-900 mb-3">连接池管理</h3>
              <p class="text-sm text-blue-800">
                使用连接池复用数据库连接，避免频繁创建销毁开销
                <a href="https://blog.csdn.net/qq_30939943/article/details/141952835" class="citation-link">[122]</a>
              </p>
            </div>
            <div class="bg-green-50 rounded-xl p-6 border border-green-200 text-center">
              <i class="fas fa-chart-line text-3xl text-green-600 mb-4"></i>
              <h3 class="font-serif text-lg font-semibold text-green-900 mb-3">内存监控</h3>
              <p class="text-sm text-green-800">
                实时监控内存使用，设置阈值告警，防止OOM错误
                <a href="https://liuzaoqi.com/docs/data-analysis/Pandas/memory_management" class="citation-link">[189]</a>
              </p>
            </div>
            <div class="bg-purple-50 rounded-xl p-6 border border-purple-200 text-center">
              <i class="fas fa-redo text-3xl text-purple-600 mb-4"></i>
              <h3 class="font-serif text-lg font-semibold text-purple-900 mb-3">重试机制</h3>
              <p class="text-sm text-purple-800">
                区分临时性失败和永久性失败，实现智能重试策略
              </p>
            </div>
          </div>

          <div class="bg-gradient-to-r from-gray-50 to-gray-100 rounded-xl p-6">
            <h3 class="font-serif text-xl font-semibold text-gray-900 mb-4">关键性能建议</h3>
            <div class="grid md:grid-cols-2 gap-6">
              <div>
                <h4 class="font-medium text-gray-900 mb-3 flex items-center">
                  <i class="fas fa-rocket text-accent mr-2"></i>数据处理优化
                </h4>
                <ul class="text-sm text-gray-700 space-y-2">
                  <li>• 使用pandas的chunksize参数分块处理数据</li>
                  <li>• 优化数据类型，使用int32替代int64</li>
                  <li>• 将重复字符串转换为category类型</li>
                </ul>
              </div>
              <div>
                <h4 class="font-medium text-gray-900 mb-3 flex items-center">
                  <i class="fas fa-cogs text-accent mr-2"></i>系统配置优化
                </h4>
                <ul class="text-sm text-gray-700 space-y-2">
                  <li>• 合理设置连接池大小和超时时间</li>
                  <li>• 调整Doris的exec_mem_limit参数</li>
                  <li>• 配置合适的压缩算法和级别</li>
                </ul>
              </div>
            </div>
          </div>
        </section>
      </div>

      <!-- 底部总结 -->
      <section class="bg-primary text-white py-16">
        <div class="max-w-5xl mx-auto px-8">
          <div class="text-center mb-12">
            <h2 class="font-serif text-3xl font-bold mb-6">方案总结</h2>
            <p class="text-xl text-blue-100 max-w-3xl mx-auto">
              通过异步化、流式处理、文件分片三大核心技术，为MySQL和Doris的大数据量导出提供了完整、高效、可靠的解决方案
            </p>
          </div>

          <div class="grid md:grid-cols-3 gap-8 text-center">
            <div>
              <i class="fas fa-check-circle text-4xl text-blue-200 mb-4"></i>
              <h3 class="font-semibold text-lg mb-2">可靠性保证</h3>
              <p class="text-blue-100 text-sm">完善的错误处理、重试机制和监控告警体系</p>
            </div>
            <div>
              <i class="fas fa-zap text-4xl text-blue-200 mb-4"></i>
              <h3 class="font-semibold text-lg mb-2">高性能导出</h3>
              <p class="text-blue-100 text-sm">支持千万级数据导出，内存占用稳定可控</p>
            </div>
            <div>
              <i class="fas fa-user-check text-4xl text-blue-200 mb-4"></i>
              <h3 class="font-semibold text-lg mb-2">用户体验</h3>
              <p class="text-blue-100 text-sm">异步处理避免等待，压缩打包便于下载</p>
            </div>
          </div>
        </div>
      </section>
    </main>

    <script>
        // 平滑滚动
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // 目录高亮
        const sections = document.querySelectorAll('section[id]');
        const tocLinks = document.querySelectorAll('.toc-link');

        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (scrollY >= sectionTop - 200) {
                    current = section.getAttribute('id');
                }
            });

            tocLinks.forEach(link => {
                link.classList.remove('bg-blue-100', 'border-l-3', 'border-blue-500');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('bg-blue-100', 'border-l-3', 'border-blue-500');
                }
            });
        });
    </script>
  

</body></html>